[2026-02-09 11:20:56,917] INFO - Starting training with config:
seed: 234
device: cuda
num_epochs: 15
batch_size: 16
num_workers: 2
lr: 0.0005
tasks:
  enable_seg: true
  enable_cls: true
data:
  use_dummy: false
  use_slide_manifest: true
  train_slide_manifest: data/processed/manifest_slides_train.csv
  val_slide_manifest: data/processed/manifest_slides_val.csv
  coords_cache_slides: 2
  cache_masks: false
  mask_level: null
  mask_max_size: 4096
  normalize: imagenet
  imagenet_mean:
  - 0.485
  - 0.456
  - 0.406
  imagenet_std:
  - 0.229
  - 0.224
  - 0.225
  train_images: data/train/images_fixed
  train_masks: data/train/masks_fixed
  train_labels: data/train/labels.csv
  val_images: data/val/images_fixed
  val_masks: data/val/masks_fixed
  val_labels: data/val/labels.csv
  test_images: data/test/images_fixed
  test_masks: data/test/masks_fixed
  test_labels: data/test/labels.csv
  dummy:
    train_samples: 8
    val_samples: 4
    test_samples: 4
    image_size: 128
aug:
  flip_p: 0.5
  affine:
    degrees: 10.0
    translate: 0.05
    scale_range:
    - 0.95
    - 1.05
    shear: 5.0
    p: 0.7
  elastic:
    alpha: 0.05
    grid_size: 4
    p: 0.3
loader:
  stratified_train: false
  stratified_val: false
  slide_weighted_sampling: true
  slide_samples_per_epoch: 300000
  slide_weighted_replacement: true
  val_slide_weighted_sampling: true
  val_slide_samples_per_epoch: 120000
  val_slide_weighted_replacement: true
  train_positive_ratio: 0.38
  train_drop_last: false
  val_positive_ratio: 0.51
model:
  backbone: mobilenet_v2
  num_classes: 1
  seg_upsample_to_input: true
  pretrained: true
  mobilenet_width_mult: 1.0
  use_light_decoder: true
  attention: se
  attention_location: decoder
  encoder_attention: null
  decoder_attention: null
  attention_reduction: 16
  decoder_attention_layers:
  - up4
loss:
  seg: bce_with_logits
  seg_weight: 1.0
  cls_weight: 1.0
  dice_weight: 0.5
  cls: bce
  weighting: fixed
  use_uncertainty: false
  uncertainty_init: 0.0
  gradnorm_alpha: 1.5
log:
  save_timing_dir: ${hydra:runtime.output_dir}
  save_dir: ${hydra:runtime.output_dir}
  save_ckpt: true
  train_log_interval: 20
  val_log_interval: 20
  params_dir: ${hydra:runtime.output_dir}
  roc_dir: ${hydra:runtime.output_dir}/roc
eval:
  ckpt: null
  save_dir: ${log.params_dir}
  save_roc: true
prepare_train:
  slides_dir: data/camelyon16/train/images
  masks_dir: data/camelyon16/train/masks
  annotations_dir: data/camelyon16/annotations
  manifest_path: data/processed/patch_manifest_train.csv
  patch_level: 0
  patch_size: 256
  patch_stride: 256
  tissue_level: null
  min_tissue: 0.5
  pos_threshold: 0.5
  neg_threshold: 0.0
  neg_keep_prob: 0.2
  seed: 42
  groups: Tumor
  max_patches_per_slide: 1500
  sampling_mode: stratified_random
  target_pos_ratio: 0.5
  slide_labels_csv: null
  slide_label_fallback_to_sampled: false
  mask_suffix: _mask.tif
  prefer_masks: false
  progress_interval: 5000
  mask_level: null
  mask_max_size: null
  tissue_max_size: 4096
  coords_out_dir: data/processed/coords/train
  slide_manifest_path: data/processed/manifest_slides_train.csv
  write_patch_manifest: false
prepare_val:
  slides_dir: data/camelyon16/val/images
  masks_dir: data/camelyon16/val/masks
  annotations_dir: data/camelyon16/annotations
  manifest_path: data/processed/patch_manifest_val.csv
  patch_level: 0
  patch_size: 256
  patch_stride: 256
  tissue_level: null
  min_tissue: 0.5
  pos_threshold: 0.5
  neg_threshold: 0.0
  neg_keep_prob: 0.2
  seed: 42
  groups: Tumor
  max_patches_per_slide: 1500
  sampling_mode: stratified_random
  target_pos_ratio: 0.5
  slide_labels_csv: null
  slide_label_fallback_to_sampled: false
  mask_suffix: _mask.tif
  prefer_masks: false
  progress_interval: 5000
  mask_level: null
  mask_max_size: null
  tissue_max_size: 4096
  coords_out_dir: data/processed/coords/val
  slide_manifest_path: data/processed/manifest_slides_val.csv
  write_patch_manifest: false

[2026-02-09 11:20:56,917] INFO - Loss weighting strategy: fixed
[2026-02-09 11:20:56,940] INFO - Using weighted sampling for SlideCoordsDataset: samples_per_epoch=300000 pool=318479 pos=32265 neg=286214
[2026-02-09 11:20:56,944] INFO - Using weighted sampling for SlideCoordsDataset (val): samples_per_epoch=120000 pool=73693 pos=10116 neg=63577
[2026-02-09 11:20:56,944] INFO - Loaded 54 slide-level labels from validation dataset metadata.
[2026-02-09 11:20:58,507] INFO - Train epoch=1 step=1/18750 loss=1.1862 seg=0.4715 cls=0.7147
